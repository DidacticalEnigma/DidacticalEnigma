image:
  - Visual Studio 2017
  - Ubuntu
configuration: Release
build:
  project: DidacticalEnigma.sln
  verbosity: minimal
install:
  - ps: cd $env:APPVEYOR_BUILD_FOLDER
  - ps: git submodule update --init --recursive
  - ps: nuget restore
  - ps: dotnet publish MagicTranslatorGlosser/MagicTranslatorGlosser.csproj -c Release -r linux-x64 --self-contained false -o $env:APPVEYOR_BUILD_FOLDER/DidacticalEnigma/bin/Release/MagicTranslatorGlosser
  - ps: dotnet publish MagicTranslatorGlosser/MagicTranslatorGlosser.csproj -c Release -r win-x64 --self-contained false -o $env:APPVEYOR_BUILD_FOLDER/DidacticalEnigma/bin/Release/MagicTranslatorGlosser
after_build:
  - ps: mv $env:APPVEYOR_BUILD_FOLDER/DidacticalEnigma/bin/Release $env:APPVEYOR_BUILD_FOLDER/DidacticalEnigma/bin/DidacticalEnigma
  - ps: 7z a -r DidacticalEnigma.zip $env:APPVEYOR_BUILD_FOLDER/DidacticalEnigma/bin/DidacticalEnigma
artifacts:
  - path: DidacticalEnigma.zip
    name: Full program
    type: zip
deploy:
  tag: $(APPVEYOR_REPO_TAG_NAME)
  description: 'This is the full program, with all the files needed for it to work.'
  provider: GitHub
  auth_token:
    secure: fzqkckOMapDGnWMt0ZWxBM4k+pxuAQtdO7H4sUj3nqqk65Cm+UYKUf7f6I3AqQIM
  artifact: DidacticalEnigma.zip
  draft: false
  prerelease: false
  on:
    branch: master
    APPVEYOR_REPO_TAG: true

